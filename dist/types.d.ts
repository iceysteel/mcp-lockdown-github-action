/** Response from POST /api/tests */
export interface TestInfo {
    test_id: string;
    technique_id: string;
    repo_url: string;
    status: string;
    created_at: string;
    started_at: string | null;
    completed_at: string | null;
}
/** Response from POST /api/queues */
export interface QueueInfo {
    queue_id: string;
    repo_url: string;
    status: string;
    technique_ids: string[];
    created_at: string;
}
/** Response from GET /api/queues/{id} */
export interface QueueDetail extends QueueInfo {
    test_ids: Record<string, string>;
    completed_techniques: string[];
    skipped_techniques: string[];
    failed_techniques: string[];
    current_test_id: string | null;
    current_technique_id: string | null;
    current_technique_index: number;
    total_techniques: number;
    error: string | null;
}
/** Response from GET /api/tests/{id} â€” the detail view with result */
export interface TestDetail extends TestInfo {
    steps_completed: number;
    current_step: Record<string, unknown> | null;
    result: TestResult | null;
    error: string | null;
    steps: Record<string, unknown>[];
}
/** The result wrapper stored on a completed test */
export interface TestResult {
    test_id: string;
    mcp_server: string;
    technique: Record<string, unknown>;
    container_exit_code: number;
    timestamp: string;
    report: TestReport;
    success: boolean;
}
/** The actual report generated by the agent */
export interface TestReport {
    technique_id: string;
    repository: string;
    vulnerability_status: VulnerabilityStatus;
    deployment: {
        prompt: string;
        response: string;
        success: boolean;
        steps: number;
    };
    attack_result: {
        prompt: string;
        response: string;
        success: boolean;
        steps: number;
    };
    evidence: Evidence[];
    conversation_log: unknown[];
    raw_response?: string;
}
export interface Evidence {
    original_path?: string;
    evidence_path?: string;
    evidence_filename: string;
    description: string;
    category: 'payload' | 'server_code' | 'config' | 'output';
    size_bytes?: number;
    timestamp?: string;
}
export type VulnerabilityStatus = 'vulnerable' | 'not_vulnerable' | 'test_failed' | 'unknown';
/** Scan handle returned by the API client (works for both single tests and queues) */
export interface ScanHandle {
    id: string;
    type: 'test' | 'queue';
    techniqueIds: string[];
}
export interface PollOptions {
    timeoutMs: number;
    pollIntervalMs: number;
    onTechniqueComplete: (testId: string, report: TestReport) => Promise<void>;
}
